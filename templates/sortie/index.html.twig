{% extends 'base.html.twig' %}

{% block title %}Filtrer les sorties{% endblock %}

{% block body %}

    <h1>Filtrer les sorties</h1>
        {# {{ form_start(formView) }}
        <div class="row">
            <div class="col-4">
                {{ form_row(formView.lieuxNoLieu) }}
            </div>
            <div class="col-4">
                {{ form_row(formView.nom) }}
            </div>
            <div class="col-4">
            </div>
        </div>
        <div class="row">
            <div class="col-4">
            {{ form_row(formView.datedebut) }}
            </div>
            <div class="col-4">
            {{ form_row(formView.datecloture) }}
            </div>
        <input type="submit" value="Rechercher">

        {{ form_end(formView) }} #}

    <table id="table_id" class="display">
    <thead>
        <tr>
            <th>Nom</th>
            <th>Date début</th>
            <th>Date clôture</th>
            <th>Nombre inscrit/nombre max</th>
            <th>Etat sortie</th>
            <th>Inscrit</th>
            <th>Organisateur</th>
            <th>Action</th>
        </tr>
      
    </thead>
    <tbody>
        {% for sortie in lesSorties %}
           <tr>
           
                <td>{{sortie.nom}}</td>
                {# <td>{{sortie.datedebut}}</td>
                <td>{{sortie.datecloture}}</td> #}
                <td>{{sortie.datedebut|date("d/m/Y")}}</td>
                <td>{{sortie.datecloture|date("d/m/Y")}}</td>
                <td>nombre inscrit à faire/{{sortie.nbinscriptionsmax}}</td>
                <td>{{sortie.etatsNoEtat.libelle}}</td>
                <td>si inscrit à faire</td>
                
                <td><a href="{{path('afficherProfile', {'id':sortie.organisateur.noParticipant}) }}">{{sortie.organisateur.prenom}}</a></td>
                <td>action à faire</td>
           </tr> 
        {% endfor %}

    </tbody>
    <tfoot>
        <tr id="research">
            <th>Nom</th>
            <th>Date début</th>
            <th>Date clôture</th>
            <th>Nombre inscrit/nombre max</th>
            <th>Etat sortie</th>
            <th>Inscrit</th>
            <th>Organisateur</th>
            <th>Action</th>
        </tr>
    </tfoot>
</table>
 <script>
{# $(document).ready( function () {
    $('#table_id').DataTable();
} ); #}

$(document).ready(function() {
    // Setup - add a text input to each footer cell
    $('#table_id #research th').each( function () {
        var title = $(this).text();
        $(this).html( '<input type="text" placeholder="Search '+title+'" />' );
    } );
 
    // DataTable
    var table = $('#table_id').DataTable({
        initComplete: function () {
            // Apply the search
            this.api().columns().every( function () {
                var that = this;
 
                $( 'input', this.footer() ).on( 'keyup change clear', function () {
                    if ( that.search() !== this.value ) {
                        that
                            .search( this.value )
                            .draw();
                    }
                } );
            } );
            this.api().columns(0).every( function () {
              var column = this;
                var select = $('<select><option value=""></option></select>')
                    .appendTo( $(column.footer()).empty() )
                    .on( 'change', function () {
                        var val = $.fn.dataTable.util.escapeRegex(
                            $(this).val()
                        );
 
                        column
                            .search( val ? '^'+val+'$' : '', true, false )
                            .draw();
                    } );
 
                column.data().unique().sort().each( function ( d, j ) {
                    select.append( '<option value="'+d+'">'+d+'</option>' )
                } );
            });
        }
    });
 
} );
 </script>       
{% endblock %}
